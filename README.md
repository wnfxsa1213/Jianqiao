# 剑鞘核心 (JianqiaoCoreShell)

## 项目简介

"剑鞘核心"是一款基于 Qt 6 和 C++ 开发的 Windows 平台应用程序，旨在提供一个受控的、沉浸式的操作环境。其核心目标是创建一个"霸屏"应用，用户在该环境下只能与管理员预设的白名单应用程序进行交互，同时屏蔽常规的桌面访问和部分系统快捷键。

本项目主要面向需要高度定制化和受限操作场景的环境，例如特定工作站、展示设备或儿童安全模式等。

## 当前状态

项目目前处于积极开发阶段。核心框架和基本功能已初步实现，包括：

*   全屏主应用程序框架 (`JianqiaoCoreShell`)。
*   通过 `QStackedWidget` 管理用户视图 (`UserView`) 和管理员仪表盘 (`AdminDashboardView`)。
*   管理员通过自定义热键登录 (`AdminLoginView`)。
*   `AdminDashboardView` 中初步实现白名单应用管理（增删查）和管理员登录热键配置。
*   `UserView` 中以Dock栏形式展示白名单应用，并支持启动。
*   配置信息 (管理员密码哈希, 白名单应用, 热键) 通过 `config.json` 持久化。
*   初步实现管理员退出整个程序的功能。

**尚存问题和待开发功能较多，详见"待办事项/未来计划"。**

## 主要特性

### 已初步实现或正在开发：
*   **全屏沉浸式环境**: 应用启动后全屏显示，覆盖桌面和任务栏。
*   **管理员模式**:
    *   通过全局热键唤醒登录界面。
    *   密码安全验证 (SHA256哈希)。
    *   统一的管理员仪表盘 (`AdminDashboardView`)：
        *   白名单应用管理：添加、移除可执行程序。
        *   管理员登录热键自定义配置。
        *   退出整个应用程序。
*   **用户模式**:
    *   仅显示和允许启动白名单中的应用程序。
    *   底部Dock栏风格的应用启动器。
*   **系统交互**:
    *   底层键盘钩子 (`WH_KEYBOARD_LL`) 用于热键检测。
    *   窗口控制API的初步封装，用于尝试置顶白名单应用。
*   **配置文件**: 使用 `config.json` 存储各项配置。

### 计划中 / 待增强：
*   **完善的用户模式快捷键拦截**: 阻止如 Win 键、Alt+Tab、Ctrl+Esc 等系统快捷键。
*   **精细化窗口层级控制**: 确保白名单应用始终在"剑鞘核心"之上，而"剑鞘核心"始终在桌面之上。
*   **应用图标的可靠加载与显示**: 解决当前部分图标无法正确加载的问题。
*   **管理员密码修改**: 在 `AdminDashboardView` 中提供UI。
*   **更现代化的UI/UX**:
    *   `UserView`: 支持卡片式/Launchpad式布局，动态背景/毛玻璃效果。
    *   `AdminDashboardView`: 优化布局，支持搜索/过滤，操作按钮图标化。
    *   流畅的过渡动画。
*   **应用状态监控**: 监控白名单应用的运行状态（如意外退出）。
*   **更详细的错误处理与日志记录**。
*   **系统主题/行为等更多管理员配置项**。

## 技术栈

*   **语言**: C++ (C++17 或更高标准)
*   **框架**: Qt 6 (Widgets)
*   **构建系统**: CMake
*   **目标平台**: Windows (目前主要针对Windows开发)
*   **配置文件格式**: JSON

## 如何编译与运行 (基本指南)

1.  **环境要求**:
    *   支持C++17的C++编译器 (如 MSVC)。
    *   Qt 6 SDK (包含 Qt Widgets, Qt GUI, Qt Core 等模块)。
    *   CMake (版本 3.16 或更高)。
2.  **编译步骤**:
    *   克隆本仓库。
    *   打开CMake GUI或使用命令行CMake：
        *   设置源代码目录。
        *   设置构建目录。
        *   点击 "Configure"，选择合适的生成器 (例如 Visual Studio)。
        *   确保CMake能找到Qt6的安装路径 (可能需要设置 `CMAKE_PREFIX_PATH`)。
        *   点击 "Generate"。
    *   使用选择的IDE（如Visual Studio）打开生成的项目文件并编译，或者在构建目录运行相应的构建命令 (如 `cmake --build .` 或 `nmake/jom/make`)。
3.  **运行**:
    *   编译成功后，可执行文件通常位于构建目录的子文件夹中（例如 `Debug` 或 `Release`）。
    *   首次运行时，可能会在用户配置目录 (`%APPDATA%/<AppName>` 或程序所在目录，具体取决于 `QStandardPaths` 的行为和配置保存逻辑) 创建一个默认的 `config.json` 文件。
    *   默认管理员密码为 "admin"。
    *   默认管理员登录热键通常是 Ctrl+Alt+Shift+L (具体见代码中 `initializeDefaultAdminHotkey` 或 `config.json`)。

## 待办事项 / 未来计划

*   **功能完善**:
    *   [ ] **核心**: 实现用户模式下的全面快捷键拦截。
    *   [ ] **核心**: 建立健壮的窗口层级持续控制器 (`WindowOrderController`)。
    *   [ ] **核心**: 解决白名单应用图标加载不完整/失败的问题。
    *   [ ] **管理员**: 在 `AdminDashboardView` 中集成密码修改功能。
    *   [ ] **用户模式**: 实现应用状态监控。
*   **UI/UX 提升**:
    *   [ ] `UserView`: 探索卡片式/Launchpad布局，实现高级背景效果。
    *   [ ] `AdminDashboardView`: 优化UI。
    *   [ ] 全局: 实现流畅的界面过渡动画。
*   **健壮性与细节**:
    *   [ ] 测试并确保管理员热键更改后无需重启应用即可生效。
    *   [ ] 完善错误处理和日志系统。
    *   [ ] 确保任务栏被可靠隐藏。
    *   [ ] 解决概率性CMD窗口弹出的问题。
*   **Linter错误**: 修复IDE中 `includePath`相关的Linter提示。
*   **后期**: 性能分析与优化，全面的多场景测试，打包与部署方案。
