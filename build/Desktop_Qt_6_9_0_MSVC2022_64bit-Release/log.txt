--- Log started at 2025-05-29 09:19:22 ---
2025-05-29 09:19:22.851 DEBUG:   Application started.
2025-05-29 09:19:22.851 DEBUG:   剑鞘核心(JianqiaoCoreShell): 构造函数开始。
2025-05-29 09:19:22.851 DEBUG:   剑鞘核心(JianqiaoCoreShell): 初始化核心应用设置。
2025-05-29 09:19:22.851 DEBUG:   SystemInteractionModule: Config path set to: "C:\\Users\\13027\\AppData\\Roaming\\雪鸮团队\\剑鞘系统/../JianqiaoSystem/config.json"
2025-05-29 09:19:22.851 DEBUG:   SystemInteractionModule (loadConfiguration): Attempting to load config from: "C:\\Users\\13027\\AppData\\Roaming\\雪鸮团队\\剑鞘系统/../JianqiaoSystem/config.json"
2025-05-29 09:19:22.852 DEBUG:   管理员登录热键已从配置文件加载: "VK_SHIFT + VK_CONTROL + VK_MENU + A"
2025-05-29 09:19:22.852 DEBUG:   用户模式下需拦截的独立按键已从配置文件加载: "VK_RWIN, VK_LWIN"
2025-05-29 09:19:22.852 DEBUG:   用户模式下需拦截的组合键已加载: "VK_MENU + VK_TAB"
2025-05-29 09:19:22.852 DEBUG:   用户模式下需拦截的组合键已加载: "VK_CONTROL + VK_SHIFT + VK_ESCAPE"
2025-05-29 09:19:22.852 DEBUG:   用户模式下需拦截的组合键已加载: "VK_LWIN + D"
2025-05-29 09:19:22.852 DEBUG:   用户模式下需拦截的组合键已加载: "VK_LWIN + L"
2025-05-29 09:19:22.852 DEBUG:   用户模式下需拦截的组合键已加载: "VK_LWIN + VK_TAB"
2025-05-29 09:19:22.852 DEBUG:   用户模式下需拦截的组合键已加载: "VK_CONTROL + VK_ESCAPE"
2025-05-29 09:19:22.852 WARNING: 配置文件中无效的拦截组合键中的键名: "VK_F4"
2025-05-29 09:19:22.852 DEBUG:   用户模式下需拦截的组合键已加载: "VK_MENU"
2025-05-29 09:19:22.852 DEBUG:   用户模式下需拦截的组合键已加载: "VK_LWIN + S"
2025-05-29 09:19:22.852 DEBUG:   用户模式下需拦截的组合键已加载: "VK_LWIN + A"
2025-05-29 09:19:22.852 DEBUG:   用户模式下需拦截的组合键已加载: "VK_LWIN + N"
2025-05-29 09:19:22.852 DEBUG:   用户模式下需拦截的组合键已加载: "VK_LWIN + VK_SHIFT + S"
2025-05-29 09:19:22.852 DEBUG:   用户模式下需拦截的组合键已加载: "VK_LWIN + E"
2025-05-29 09:19:22.852 DEBUG:   用户模式下需拦截的组合键已加载: "VK_LWIN + R"
2025-05-29 09:19:22.852 DEBUG:   用户模式下需拦截的组合键已加载: "VK_LWIN + I"
2025-05-29 09:19:22.852 DEBUG:   用户模式下需拦截的组合键已加载: "VK_LWIN + X"
2025-05-29 09:19:22.852 DEBUG:   用户模式下需拦截的组合键已加载: "VK_LWIN + P"
2025-05-29 09:19:22.852 DEBUG:   用户模式下需拦截的组合键已加载: "VK_LWIN + K"
2025-05-29 09:19:22.852 DEBUG:   用户模式下需拦截的组合键已加载: "VK_CONTROL + VK_MENU + VK_DELETE"
2025-05-29 09:19:22.852 DEBUG:   系统交互模块(SystemInteractionModule): 已创建。
2025-05-29 09:19:22.852 DEBUG:   [SystemInteractionModule] 探测等待时间(ms): 10000
2025-05-29 09:19:22.852 DEBUG:   剑鞘核心(JianqiaoCoreShell): 底层系统交互模块已实例化。
2025-05-29 09:19:22.852 DEBUG:   用户视图(UserView): 已创建。
2025-05-29 09:19:22.868 DEBUG:   UserView: Background image set to ":/images/user_bg.jpg"
2025-05-29 09:19:22.868 DEBUG:   管理员仪表盘(AdminDashboardView): 已创建。
2025-05-29 09:19:22.875 DEBUG:   剑鞘核心外壳: UI设置完成 (QStackedWidget), 视图实例已创建。
2025-05-29 09:19:22.875 DEBUG:   管理员登录视图(AdminLoginView): 成功加载 AdminLoginView.qss
2025-05-29 09:19:22.875 DEBUG:   管理员登录视图(AdminLoginView): 已创建。
2025-05-29 09:19:22.875 DEBUG:   管理员模块(AdminModule): 构造函数开始。
2025-05-29 09:19:22.875 DEBUG:   管理员模块(AdminModule): 尝试从以下路径加载配置文件: "C:\\Users\\13027\\AppData\\Roaming\\雪鸮团队\\剑鞘系统/../JianqiaoSystem/config.json"
2025-05-29 09:19:22.875 DEBUG:   管理员模块(AdminModule): 已加载管理员密码哈希。
2025-05-29 09:19:22.875 DEBUG:   管理员模块(AdminModule): 已加载管理员登录热键: "VK_SHIFT + VK_CONTROL + VK_MENU + A"
2025-05-29 09:19:22.875 DEBUG:   [SIM::getIcon] Attempting to get icon for: "C:/Users/13027/AppData/Local/Kingsoft/WPS Office/ksolaunch.exe"
2025-05-29 09:19:22.876 DEBUG:   [SIM::getIcon] QFileIconProvider.icon(fileInfo) called.
2025-05-29 09:19:22.968 DEBUG:   [SIM::getIcon] Got large pixmap from QFileIconProvider, size: QSize(256, 256)
2025-05-29 09:19:22.968 DEBUG:   管理员模块(AdminModule): 已加载白名单应用: "WPS" Path: "C:/Users/13027/AppData/Local/Kingsoft/WPS Office/ksolaunch.exe" Hint: ""
2025-05-29 09:19:22.968 DEBUG:     with WindowHints: "{\"allowNonTopLevel\":true,\"minScore\":50,\"primaryClassName\":\"OpusApp\",\"titleContains\":\"WPS Office\"}"
2025-05-29 09:19:22.968 DEBUG:   管理员模块(AdminModule): 共加载 1 个白名单应用。
2025-05-29 09:19:22.968 DEBUG:   管理员模块(AdminModule): 准备填充管理员仪表盘数据。
2025-05-29 09:19:22.968 DEBUG:   管理员模块(AdminModule): prepareAdminDashboardData() 调用。
2025-05-29 09:19:22.968 DEBUG:   AdminDashboardView::setWhitelistedApps called with 1 apps.
2025-05-29 09:19:22.969 DEBUG:   AdminDashboardView: Current admin hotkey display updated to: "VK_SHIFT + VK_CONTROL + VK_MENU + A"
2025-05-29 09:19:22.969 DEBUG:   管理员模块(AdminModule): 管理员仪表盘视图数据已准备就绪。
2025-05-29 09:19:22.969 DEBUG:   管理员模块(AdminModule): 配置文件加载完成。
2025-05-29 09:19:22.969 DEBUG:   管理员模块(AdminModule): 构造函数结束。
2025-05-29 09:19:22.969 DEBUG:   UserModeModule::loadConfiguration - Loaded app: "WPS" Path: "C:/Users/13027/AppData/Local/Kingsoft/WPS Office/ksolaunch.exe" Hint: ""
2025-05-29 09:19:22.969 DEBUG:   [SIM::getIcon] Attempting to get icon for: "C:/Users/13027/AppData/Local/Kingsoft/WPS Office/ksolaunch.exe"
2025-05-29 09:19:22.969 DEBUG:   [SIM::getIcon] QFileIconProvider.icon(fileInfo) called.
2025-05-29 09:19:22.971 DEBUG:   [SIM::getIcon] Got large pixmap from QFileIconProvider, size: QSize(256, 256)
2025-05-29 09:19:22.971 INFO:    Configuration loaded, 1 apps in whitelist.
2025-05-29 09:19:22.971 INFO:    UserModeModule initialized and connected to UserView (app launch request and app list update).
2025-05-29 09:19:22.971 DEBUG:   键盘钩子: 安装成功。
2025-05-29 09:19:22.971 DEBUG:   钩子安装，句柄: 985687
2025-05-29 09:19:22.971 DEBUG:   剑鞘核心(JianqiaoCoreShell): 已连接 SystemInteractionModule::adminLoginRequested 信号。
2025-05-29 09:19:22.971 DEBUG:   剑鞘核心(JianqiaoCoreShell): 已连接 AdminModule 信号 (exitAdminModeRequested, loginSuccessfulAndAdminActive)。
2025-05-29 09:19:22.971 DEBUG:   剑鞘核心(JianqiaoCoreShell): 切换到用户模式视图.
2025-05-29 09:19:22.971 DEBUG:   JianqiaoCoreShell: Fetched 1 apps from AdminModule's current state for UserModeModule.
2025-05-29 09:19:22.971 DEBUG:   UserModeModule::updateUserAppList - Updating apps from provided list. Count: 1
2025-05-29 09:19:22.971 DEBUG:   UserModeModule::updateUserAppList - Signal emitted to update UserView with new app list.
2025-05-29 09:19:22.971 DEBUG:   系统交互模块(SystemInteractionModule): 设置用户模式状态为: true
2025-05-29 09:19:22.971 DEBUG:   剑鞘核心(JianqiaoCoreShell): UserView is now current widget.
2025-05-29 09:19:22.971 DEBUG:   剑鞘核心(JianqiaoCoreShell): 已切换到用户模式.
2025-05-29 09:19:22.971 DEBUG:   剑鞘核心(JianqiaoCoreShell): 用户视图已显示 (初始状态)。
2025-05-29 09:19:22.971 DEBUG:   剑鞘核心(JianqiaoCoreShell): 构造函数结束。
2025-05-29 09:19:22.975 DEBUG:   UserView::populateAppList - Received 1 apps. Clearing existing cards.
2025-05-29 09:19:22.975 DEBUG:     App: "WPS" Path: "C:/Users/13027/AppData/Local/Kingsoft/WPS Office/ksolaunch.exe" Icon isNull: false
2025-05-29 09:19:25.461 DEBUG:   "用户模式下按键: VK_LCONTROL (VK: 0xa2), m_userModeActive: 1"
2025-05-29 09:19:25.521 DEBUG:   "用户模式下按键: VK_LSHIFT (VK: 0xa0), m_userModeActive: 1"
2025-05-29 09:19:25.641 DEBUG:   "用户模式下按键: VK_LMENU (VK: 0xa4), m_userModeActive: 1"
2025-05-29 09:19:25.769 DEBUG:   系统交互模块(LowLevelKeyboardProc): 管理员登录热键组合被按下。
2025-05-29 09:19:25.769 DEBUG:   剑鞘核心(JianqiaoCoreShell): 接收到管理员登录请求。
2025-05-29 09:19:25.769 DEBUG:   剑鞘核心(JianqiaoCoreShell): 系统模式设置为 AdminModePendingLogin.
2025-05-29 09:19:25.769 DEBUG:   系统交互模块(SystemInteractionModule): 设置用户模式状态为: false
2025-05-29 09:19:25.769 DEBUG:   管理员模块(AdminModule): 请求显示管理员登录视图。
2025-05-29 09:19:25.769 DEBUG:   管理员登录视图(AdminLoginView): UI已重置为初始状态。
2025-05-29 09:19:25.771 DEBUG:   管理员登录视图(AdminLoginView): 显示事件触发，尝试居中。
2025-05-29 09:19:25.775 DEBUG:   管理员模块(AdminModule): 管理员登录视图已显示。
2025-05-29 09:19:25.775 DEBUG:   剑鞘核心(JianqiaoCoreShell): 管理员登录视图已请求显示。
2025-05-29 09:19:29.281 DEBUG:   管理员登录视图(AdminLoginView): '登录'按钮被点击。
2025-05-29 09:19:29.281 DEBUG:   管理员模块(AdminModule): 收到登录尝试。
2025-05-29 09:19:29.281 DEBUG:   管理员模块(AdminModule): 验证密码 - 成功
2025-05-29 09:19:29.281 DEBUG:   管理员模块(AdminModule): 密码验证成功。
2025-05-29 09:19:29.281 DEBUG:   管理员登录视图(AdminLoginView): 登录成功，UI已更新。
2025-05-29 09:19:29.281 DEBUG:   管理员登录视图(AdminLoginView): UI已重置为初始状态。
2025-05-29 09:19:29.285 DEBUG:   管理员登录视图(AdminLoginView): hideEvent triggered.
2025-05-29 09:19:29.285 DEBUG:   管理员模块(AdminModule): 登录视图已隐藏。
2025-05-29 09:19:29.285 DEBUG:   管理员模块(AdminModule): 登录视图隐藏，且管理员仪表盘视图也不可见。
2025-05-29 09:19:29.285 DEBUG:   剑鞘核心(JianqiaoCoreShell): 管理员登录成功并处于活动状态。
2025-05-29 09:19:29.285 DEBUG:   剑鞘核心(JianqiaoCoreShell): 系统模式设置为 AdminModeActive.
2025-05-29 09:19:29.285 DEBUG:   管理员模块(AdminModule): prepareAdminDashboardData() 调用。
2025-05-29 09:19:29.285 DEBUG:   AdminDashboardView::setWhitelistedApps called with 1 apps.
2025-05-29 09:19:29.285 DEBUG:   AdminDashboardView: Current admin hotkey display updated to: "VK_SHIFT + VK_CONTROL + VK_MENU + A"
2025-05-29 09:19:29.285 DEBUG:   管理员模块(AdminModule): 管理员仪表盘视图数据已准备就绪。
2025-05-29 09:19:29.285 DEBUG:   JianqiaoCoreShell::switchToAdminDashboard() EXECUTED.
2025-05-29 09:19:29.285 DEBUG:   剑鞘核心(JianqiaoCoreShell): 切换到管理员仪表盘。
2025-05-29 09:19:29.285 DEBUG:   AdminDashboardView::setWhitelistedApps called with 1 apps.
2025-05-29 09:19:29.285 DEBUG:   AdminDashboardView: Current admin hotkey display updated to: "VK_SHIFT + VK_CONTROL + VK_MENU + A"
2025-05-29 09:19:29.285 DEBUG:   剑鞘核心(JianqiaoCoreShell): AdminDashboardView data populated.
2025-05-29 09:19:29.287 DEBUG:   剑鞘核心(JianqiaoCoreShell): AdminDashboard is now current widget. StackedWidget Geometry: QRect(0,0 1707x1067)
2025-05-29 09:19:33.410 DEBUG:   AdminDashboardView::onRemoveAppClicked INVOKED.
2025-05-29 09:19:33.410 DEBUG:   AdminDashboardView: Remove App button clicked.
2025-05-29 09:19:33.410 DEBUG:   AdminDashboardView: Emitting whitelistChanged with 0 apps.
2025-05-29 09:19:33.410 DEBUG:   [AdminModule] onWhitelistUpdated CALLED. Received 0 apps.
2025-05-29 09:19:33.411 DEBUG:   [AdminModule::saveWhitelistToConfig] Attempting to save 0 apps to: "C:\\Users\\13027\\AppData\\Roaming\\雪鸮团队\\剑鞘系统/../JianqiaoSystem/config.json"
2025-05-29 09:19:33.411 DEBUG:   管理员模块(AdminModule): 0 个应用已序列化到JSON。
2025-05-29 09:19:33.411 DEBUG:   管理员模块(AdminModule): 白名单已成功写入并通过 configFile.close()。
2025-05-29 09:19:33.411 DEBUG:   [AdminModule::saveWhitelistToConfig] Verification: Successfully re-opened config file for reading.
2025-05-29 09:19:33.411 DEBUG:   [AdminModule::saveWhitelistToConfig] Verification: Content after save:
 "{\n    \"admin_password\": \"240be518fabd2724ddb6f04eeb1da5967448d7e831c08c8fa822809f74c720a9\",\n    \"admin_password_hash\": \"240be518fabd2724ddb6f04eeb1da5967448d7e831c08c8fa822809f74c720a9\",\n    \"detection_wait_ms\": 10000,\n    \"shortcuts\": {\n        \"admin_login\": {\n            \"key_sequence\": [\n                \"VK_SHIFT\",\n                \"VK_CONTROL\",\n                \"VK_MENU\",\n                \"A\"\n            ]\n        }\n    },\n    \"user_mode_settings\": {\n        \"blocked_key_combinations\": [\n            [\n                \"VK_MENU\",\n                \"VK_TAB\"\n            ],\n            [\n                \"VK_CONTROL\",\n                \"VK_SHIFT\",\n                \"VK_ESCAPE\"\n            ],\n            [\n                \"VK_LWIN\",\n                \"D\"\n            ],\n            [\n                \"VK_LWIN\",\n                \"L\"\n            ],\n            [\n                \"VK_LWIN\",\n                \"VK_TAB\"\n            ],\n            [\n                \"VK_CONTROL\",\n                \"VK_ESCAPE\"\n            ],\n            [\n                \"VK_MENU\",\n                \"VK_F4\"\n            ],\n            [\n                \"VK_LWIN\",\n                \"S\"\n            ],\n            [\n                \"VK_LWIN\",\n                \"A\"\n            ],\n            [\n                \"VK_LWIN\",\n                \"N\"\n            ],\n            [\n                \"VK_LWIN\",\n                \"VK_SHIFT\",\n                \"S\"\n            ],\n            [\n                \"VK_LWIN\",\n                \"E\"\n            ],\n            [\n                \"VK_LWIN\",\n                \"R\"\n            ],\n            [\n                \"VK_LWIN\",\n                \"I\"\n            ],\n            [\n                \"VK_LWIN\",\n                \"X\"\n            ],\n            [\n                \"VK_LWIN\",\n                \"P\"\n            ],\n            [\n                \"VK_LWIN\",\n                \"K\"\n            ],\n            [\n                \"VK_CONTROL\",\n                \"VK_MENU\",\n                \"VK_DELETE\"\n            ]\n        ],\n        \"blocked_keys\": [\n            \"VK_LWIN\",\n            \"VK_RWIN\"\n        ]\n    },\n    \"whitelist_apps\": [\n    ]\n}\n"
2025-05-29 09:19:33.411 DEBUG:   管理员模块(AdminModule): 更新后的白名单已成功保存到 config.json。
2025-05-29 09:19:37.314 DEBUG:   AdminDashboardView::onExitApplicationClicked INVOKED.
2025-05-29 09:19:37.314 DEBUG:   管理员仪表盘(AdminDashboardView): '退出整个程序' 按钮被点击。应用程序将退出。
2025-05-29 09:19:37.314 DEBUG:   尝试卸载钩子，当前句柄: 985687
2025-05-29 09:19:37.314 DEBUG:   键盘钩子: 卸载成功。
2025-05-29 09:19:37.322 DEBUG:   Application finished with exit code: 0
--- Log finished at 2025-05-29 09:19:37 ---
2025-05-29 09:19:37.323 DEBUG:   剑鞘核心(JianqiaoCoreShell): 已销毁。
2025-05-29 09:19:37.323 DEBUG:   尝试卸载钩子，当前句柄: 0
2025-05-29 09:19:37.323 DEBUG:   键盘钩子: 无需卸载，当前未安装钩子。
2025-05-29 09:19:37.323 DEBUG:   [SystemInteractionModule] SystemInteractionModule destroyed.
2025-05-29 09:19:37.323 DEBUG:   用户视图(UserView): 已销毁。
2025-05-29 09:19:37.324 DEBUG:   管理员仪表盘(AdminDashboardView): 已销毁。
2025-05-29 09:19:37.325 DEBUG:   管理员登录视图(AdminLoginView): 已销毁。
2025-05-29 09:19:37.327 DEBUG:   管理员模块(AdminModule): 销毁。
2025-05-29 09:19:37.327 INFO:    UserModeModule destroyed.
